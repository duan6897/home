{"remainingRequest":"E:\\zhongqiyan\\conmuser_data\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\zhongqiyan\\conmuser_data\\src\\views\\HomepagePictures\\homePagePictures.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\zhongqiyan\\conmuser_data\\src\\views\\HomepagePictures\\homePagePictures.vue","mtime":1591944345010},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgaHR0cHJlcXVlc3QgZnJvbSAnQC9hc3NldHMvYXBpL3JlcXVlc3QnDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEgKCkgew0KICAgIHJldHVybiB7DQogICAgICBpbWFnZVVybDogJycNCiAgICB9DQogIH0sDQogIG1vdW50ZWQgKCkgew0KICAgIHRoaXMuaWZJbWFnZSgpDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvLyDmn6Xor6LmmK/lkKbmnInlm77niYcNCiAgICBpZkltYWdlICgpIHsNCiAgICAgIGxldCBfdGhpcyA9IHRoaXMNCiAgICAgIGh0dHByZXF1ZXN0LmdldCgnL2NvbW1vbi9pbWFnZXMnLCB7fSwgcmVzID0+IHsNCiAgICAgICAgY29uc29sZS5sb2coJ+a1i+ivlei/meS4qicsIHJlcykNCiAgICAgICAgaWYgKHJlcy5kYXRhLm9rKSB7DQogICAgICAgICAgX3RoaXMuaW1hZ2VVcmwgPSByZXMuZGF0YS5kYXRhWzBdLmZpbGV1cmwNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIC8vIOS4iuS8oOWbvueJhw0KICAgIHVwbG9hZEltYWdlIChkYXRhKSB7DQogICAgICBjb25zb2xlLmxvZygn5rWL6K+V5LiK5Lyg5Zu+54mHJywgZGF0YSkNCiAgICAgIGxldCBfdGhpcyA9IHRoaXMNCiAgICAgIGxldCBvcHRpb25zID0gew0KICAgICAgICAiZmlsZXVybCI6IGRhdGEuZGF0YS5kYXRhLnVybA0KICAgICAgfQ0KICAgICAgaHR0cHJlcXVlc3QucG9zdCgnL2NvbW1vbi9pbWFnZXMnLCBvcHRpb25zLCByZXMgPT4gew0KICAgICAgICBjb25zb2xlLmxvZygn5rWL6K+V5LiK5Lyg5paH5Lu25oiQJywgcmVzKQ0KICAgICAgICBpZiAocmVzLmRhdGEub2spIHsNCiAgICAgICAgICBfdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmlrDlop7miJDlip8nKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIF90aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5kYXRhLm1lc3NhZ2UpDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDmm7TmlrDlm77niYcNCiAgICB1cGRhdGVJbWFnZSAoZGF0YSkgew0KICAgICAgbGV0IF90aGlzID0gdGhpcw0KICAgICAgY29uc29sZS5sb2coJ+abtOaWsOWbvueJhycsIGRhdGEpDQogICAgICBsZXQgb3B0aW9ucyA9IHsNCiAgICAgICAgImZpbGV1cmwiOiBkYXRhLmRhdGEuZGF0YS51cmwsDQogICAgICAgICdpZCc6IGRhdGEuZGF0YS5kYXRhLmlkDQogICAgICB9DQogICAgICBodHRwcmVxdWVzdC5wdXQoJy9jb21tb24vaW1hZ2VzJywgb3B0aW9ucywgcmVzID0+IHsNCiAgICAgICAgY29uc29sZS5sb2coJ+a1i+ivleabtOaWsOaWh+S7tuaIkOWKnycsIHJlcykNCiAgICAgICAgaWYgKHJlcy5kYXRhLm9rKSB7DQogICAgICAgICAgX3RoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5pu05paw5oiQ5YqfJykNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBfdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMuZGF0YS5tZXNzYWdlKQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8gLy8g5LiK5Lyg5oiQ5Yqf5ZCODQogICAgLy8gaGFuZGxlQXZhdGFyU3VjY2VzcyAocmVzLCBmaWxlKSB7DQogICAgLy8gICBjb25zb2xlLmxvZygn5rWL6K+VcmVzJywgcmVzLCBmaWxlKQ0KICAgIC8vICAgLy8gdGhpcy5pbWFnZVVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZS5yYXcpOw0KICAgIC8vICAgbGV0IF90aGlzID0gdGhpcw0KICAgIC8vICAgaWYgKF90aGlzLmltYWdlVXJsICE9PSAnJykgew0KICAgIC8vICAgICBfdGhpcy51cGRhdGVJbWFnZShyZXMpDQogICAgLy8gICB9IGVsc2Ugew0KICAgIC8vICAgICBfdGhpcy51cGxvYWRJbWFnZShyZXMpDQogICAgLy8gICB9DQogICAgLy8gfSwNCiAgICAvLyDkuIrkvKDkuYvlkI4NCiAgICBiZWZvcmVBdmF0YXJVcGxvYWQgKGZpbGUpIHsNCiAgICAgIGNvbnN0IGlzSlBHID0gZmlsZS50eXBlID09PSAnaW1hZ2UvanBlZyc7DQogICAgICBjb25zdCBpc0x0Mk0gPSBmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDI7DQoNCiAgICAgIGlmICghaXNKUEcpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5LiK5Lyg5aS05YOP5Zu+54mH5Y+q6IO95pivIEpQRyDmoLzlvI8hJyk7DQogICAgICB9DQogICAgICBpZiAoIWlzTHQyTSkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfkuIrkvKDlpLTlg4/lm77niYflpKflsI/kuI3og73otoXov4cgMk1CIScpOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIGlzSlBHICYmIGlzTHQyTTsNCiAgICB9LA0KICAgIGFzeW5jICB1cGxvYWRSZXF1ZXN0IChwYXJtZXMpIHsNCiAgICAgIGxldCBfdGhpcyA9IHRoaXMNCiAgICAgIGxldCBuZXdGaWxlID0gbmV3IEZvcm1EYXRhKCkNCiAgICAgIG5ld0ZpbGUuYXBwZW5kKCdmaWxlJywgcGFybWVzLmZpbGUpDQogICAgICBhd2FpdCBodHRwcmVxdWVzdC5wb3N0RmlsZSgnL3VwbG9hZCcsIG5ld0ZpbGUsIHJlcyA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKCfmtYvor5VyZXPkuIrkvKAnLCByZXMpDQogICAgICAgIGlmIChyZXMuZGF0YS5vaykgew0KICAgICAgICAgIGlmIChfdGhpcy5pbWFnZVVybCAhPT0gJycpIHsNCiAgICAgICAgICAgIF90aGlzLnVwZGF0ZUltYWdlKHJlcykNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgX3RoaXMudXBsb2FkSW1hZ2UocmVzKQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["homePagePictures.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"homePagePictures.vue","sourceRoot":"src/views/HomepagePictures","sourcesContent":["<template>\r\n  <div id=\"homePagePictures\">\r\n    <el-upload class=\"avatar-uploader\"\r\n               action=\"\"\r\n               :show-file-list=\"false\"\r\n               :before-upload=\"beforeAvatarUpload\"\r\n               :http-request=\"uploadRequest\">\r\n      <img v-if=\"imageUrl\"\r\n           :src=\"imageUrl\"\r\n           class=\"avatar\">\r\n      <i v-else\r\n         class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n    </el-upload>\r\n  </div>\r\n</template>\r\n<script>\r\nimport httprequest from '@/assets/api/request'\r\nexport default {\r\n  data () {\r\n    return {\r\n      imageUrl: ''\r\n    }\r\n  },\r\n  mounted () {\r\n    this.ifImage()\r\n  },\r\n  methods: {\r\n    // 查询是否有图片\r\n    ifImage () {\r\n      let _this = this\r\n      httprequest.get('/common/images', {}, res => {\r\n        console.log('测试这个', res)\r\n        if (res.data.ok) {\r\n          _this.imageUrl = res.data.data[0].fileurl\r\n        }\r\n      })\r\n    },\r\n    // 上传图片\r\n    uploadImage (data) {\r\n      console.log('测试上传图片', data)\r\n      let _this = this\r\n      let options = {\r\n        \"fileurl\": data.data.data.url\r\n      }\r\n      httprequest.post('/common/images', options, res => {\r\n        console.log('测试上传文件成', res)\r\n        if (res.data.ok) {\r\n          _this.$message.success('新增成功')\r\n        } else {\r\n          _this.$message.error(res.data.message)\r\n        }\r\n      })\r\n    },\r\n    // 更新图片\r\n    updateImage (data) {\r\n      let _this = this\r\n      console.log('更新图片', data)\r\n      let options = {\r\n        \"fileurl\": data.data.data.url,\r\n        'id': data.data.data.id\r\n      }\r\n      httprequest.put('/common/images', options, res => {\r\n        console.log('测试更新文件成功', res)\r\n        if (res.data.ok) {\r\n          _this.$message.success('更新成功')\r\n        } else {\r\n          _this.$message.error(res.data.message)\r\n        }\r\n      })\r\n    },\r\n    // // 上传成功后\r\n    // handleAvatarSuccess (res, file) {\r\n    //   console.log('测试res', res, file)\r\n    //   // this.imageUrl = URL.createObjectURL(file.raw);\r\n    //   let _this = this\r\n    //   if (_this.imageUrl !== '') {\r\n    //     _this.updateImage(res)\r\n    //   } else {\r\n    //     _this.uploadImage(res)\r\n    //   }\r\n    // },\r\n    // 上传之后\r\n    beforeAvatarUpload (file) {\r\n      const isJPG = file.type === 'image/jpeg';\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      if (!isJPG) {\r\n        this.$message.error('上传头像图片只能是 JPG 格式!');\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传头像图片大小不能超过 2MB!');\r\n      }\r\n      return isJPG && isLt2M;\r\n    },\r\n    async  uploadRequest (parmes) {\r\n      let _this = this\r\n      let newFile = new FormData()\r\n      newFile.append('file', parmes.file)\r\n      await httprequest.postFile('/upload', newFile, res => {\r\n        console.log('测试res上传', res)\r\n        if (res.data.ok) {\r\n          if (_this.imageUrl !== '') {\r\n            _this.updateImage(res)\r\n          } else {\r\n            _this.uploadImage(res)\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.avatar-uploader {\r\n  width: 80%;\r\n  height: 80%;\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n  align-items: center;\r\n  i {\r\n    width: 100%;\r\n    font-size: 300px;\r\n    color: #8c939d;\r\n    text-align: center;\r\n    line-height: 100%;\r\n  }\r\n  .el-upload {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n}\r\n#homePagePictures {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n  align-items: center;\r\n  .avatar {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n}\r\n</style>"]}]}