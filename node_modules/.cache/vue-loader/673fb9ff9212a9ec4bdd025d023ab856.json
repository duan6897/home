{"remainingRequest":"E:\\zhongqiyan\\conmuser_data\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\zhongqiyan\\conmuser_data\\src\\views\\HomepagePictures\\homePagePictures.vue?vue&type=style&index=0&id=38fa7b36&lang=scss&scoped=true&","dependencies":[{"path":"E:\\zhongqiyan\\conmuser_data\\src\\views\\HomepagePictures\\homePagePictures.vue","mtime":1591944345010},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\zhongqiyan\\conmuser_data\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmF2YXRhci11cGxvYWRlciB7DQogIHdpZHRoOiA4MCU7DQogIGhlaWdodDogODAlOw0KICBib3JkZXI6IDFweCBkYXNoZWQgI2Q5ZDlkOTsNCiAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICBjdXJzb3I6IHBvaW50ZXI7DQogIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgZGlzcGxheTogZmxleDsNCiAgZmxleC1kaXJlY3Rpb246IHJvdzsNCiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogIGkgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGZvbnQtc2l6ZTogMzAwcHg7DQogICAgY29sb3I6ICM4YzkzOWQ7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGxpbmUtaGVpZ2h0OiAxMDAlOw0KICB9DQogIC5lbC11cGxvYWQgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogMTAwJTsNCiAgfQ0KfQ0KI2hvbWVQYWdlUGljdHVyZXMgew0KICB3aWR0aDogMTAwJTsNCiAgaGVpZ2h0OiAxMDAlOw0KICBkaXNwbGF5OiBmbGV4Ow0KICBmbGV4LWRpcmVjdGlvbjogcm93Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgLmF2YXRhciB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAxMDAlOw0KICB9DQp9DQo="},{"version":3,"sources":["homePagePictures.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"homePagePictures.vue","sourceRoot":"src/views/HomepagePictures","sourcesContent":["<template>\r\n  <div id=\"homePagePictures\">\r\n    <el-upload class=\"avatar-uploader\"\r\n               action=\"\"\r\n               :show-file-list=\"false\"\r\n               :before-upload=\"beforeAvatarUpload\"\r\n               :http-request=\"uploadRequest\">\r\n      <img v-if=\"imageUrl\"\r\n           :src=\"imageUrl\"\r\n           class=\"avatar\">\r\n      <i v-else\r\n         class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n    </el-upload>\r\n  </div>\r\n</template>\r\n<script>\r\nimport httprequest from '@/assets/api/request'\r\nexport default {\r\n  data () {\r\n    return {\r\n      imageUrl: ''\r\n    }\r\n  },\r\n  mounted () {\r\n    this.ifImage()\r\n  },\r\n  methods: {\r\n    // 查询是否有图片\r\n    ifImage () {\r\n      let _this = this\r\n      httprequest.get('/common/images', {}, res => {\r\n        console.log('测试这个', res)\r\n        if (res.data.ok) {\r\n          _this.imageUrl = res.data.data[0].fileurl\r\n        }\r\n      })\r\n    },\r\n    // 上传图片\r\n    uploadImage (data) {\r\n      console.log('测试上传图片', data)\r\n      let _this = this\r\n      let options = {\r\n        \"fileurl\": data.data.data.url\r\n      }\r\n      httprequest.post('/common/images', options, res => {\r\n        console.log('测试上传文件成', res)\r\n        if (res.data.ok) {\r\n          _this.$message.success('新增成功')\r\n        } else {\r\n          _this.$message.error(res.data.message)\r\n        }\r\n      })\r\n    },\r\n    // 更新图片\r\n    updateImage (data) {\r\n      let _this = this\r\n      console.log('更新图片', data)\r\n      let options = {\r\n        \"fileurl\": data.data.data.url,\r\n        'id': data.data.data.id\r\n      }\r\n      httprequest.put('/common/images', options, res => {\r\n        console.log('测试更新文件成功', res)\r\n        if (res.data.ok) {\r\n          _this.$message.success('更新成功')\r\n        } else {\r\n          _this.$message.error(res.data.message)\r\n        }\r\n      })\r\n    },\r\n    // // 上传成功后\r\n    // handleAvatarSuccess (res, file) {\r\n    //   console.log('测试res', res, file)\r\n    //   // this.imageUrl = URL.createObjectURL(file.raw);\r\n    //   let _this = this\r\n    //   if (_this.imageUrl !== '') {\r\n    //     _this.updateImage(res)\r\n    //   } else {\r\n    //     _this.uploadImage(res)\r\n    //   }\r\n    // },\r\n    // 上传之后\r\n    beforeAvatarUpload (file) {\r\n      const isJPG = file.type === 'image/jpeg';\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      if (!isJPG) {\r\n        this.$message.error('上传头像图片只能是 JPG 格式!');\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传头像图片大小不能超过 2MB!');\r\n      }\r\n      return isJPG && isLt2M;\r\n    },\r\n    async  uploadRequest (parmes) {\r\n      let _this = this\r\n      let newFile = new FormData()\r\n      newFile.append('file', parmes.file)\r\n      await httprequest.postFile('/upload', newFile, res => {\r\n        console.log('测试res上传', res)\r\n        if (res.data.ok) {\r\n          if (_this.imageUrl !== '') {\r\n            _this.updateImage(res)\r\n          } else {\r\n            _this.uploadImage(res)\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.avatar-uploader {\r\n  width: 80%;\r\n  height: 80%;\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n  align-items: center;\r\n  i {\r\n    width: 100%;\r\n    font-size: 300px;\r\n    color: #8c939d;\r\n    text-align: center;\r\n    line-height: 100%;\r\n  }\r\n  .el-upload {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n}\r\n#homePagePictures {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n  align-items: center;\r\n  .avatar {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n}\r\n</style>"]}]}